module basis
  implicit none

contains
  function emsav(x,c) result(v)
    implicit none
    real,dimension(1:10)::x
    real,dimension(0:322)::c
    real::v
    ! ::::::::::::::::::::
    real,dimension(0:322)::p

    call bemsav(x,p)
    v = dot_product(p,c)

    return
  end function emsav

  subroutine bemsav(x,p)
    implicit none
    real,dimension(1:10),intent(in)::x
    real,dimension(0:322),intent(out)::p
    ! ::::::::::::::::::::
    real,dimension(0:51)::m

    call evmono(x,m)
    call evpoly(m,p)

    return
  end subroutine bemsav

  subroutine evmono(x,m)
    implicit none
    real,dimension(1:10),intent(in)::x
    real,dimension(0:51),intent(out)::m
    !::::::::::::::::::::

    m(0) = 1.0D0
    m(1) = x(10)
    m(2) = x(9)
    m(3) = x(8)
    m(4) = x(7)
    m(5) = x(4)
    m(6) = x(6)
    m(7) = x(5)
    m(8) = x(3)
    m(9) = x(2)
    m(10) = x(1)
    m(11) = m(1)*m(2)
    m(12) = m(4)*m(5)
    m(13) = m(2)*m(6)
    m(14) = m(1)*m(7)
    m(15) = m(2)*m(8)
    m(16) = m(1)*m(9)
    m(17) = m(5)*m(6)
    m(18) = m(5)*m(7)
    m(19) = m(4)*m(8)
    m(20) = m(4)*m(9)
    m(21) = m(7)*m(8)
    m(22) = m(6)*m(9)
    m(23) = m(6)*m(8)
    m(24) = m(7)*m(9)
    m(25) = m(6)*m(7)
    m(26) = m(8)*m(9)
    m(27) = m(2)*m(17)
    m(28) = m(1)*m(18)
    m(29) = m(2)*m(19)
    m(30) = m(1)*m(20)
    m(31) = m(2)*m(23)
    m(32) = m(1)*m(24)
    m(33) = m(5)*m(25)
    m(34) = m(4)*m(26)
    m(35) = m(6)*m(21)
    m(36) = m(6)*m(24)
    m(37) = m(6)*m(26)
    m(38) = m(7)*m(26)
    m(39) = m(14)*m(19)
    m(40) = m(15)*m(18)
    m(41) = m(13)*m(20)
    m(42) = m(16)*m(17)
    m(43) = m(2)*m(35)
    m(44) = m(1)*m(36)
    m(45) = m(2)*m(37)
    m(46) = m(1)*m(38)
    m(47) = m(5)*m(35)
    m(48) = m(5)*m(36)
    m(49) = m(4)*m(37)
    m(50) = m(4)*m(38)
    m(51) = m(6)*m(38)

    return
  end subroutine evmono

  subroutine evpoly(m,p)
    implicit none
    real,dimension(0:51),intent(in)::m
    real,dimension(0:322),intent(out)::p
    !::::::::::::::::::::

    p(0) = m(0)
    p(1) = m(1) + m(2)
    p(2) = m(3)
    p(3) = m(4) + m(5)
    p(4) = m(6) + m(7) + m(8) + m(9)
    p(5) = m(10)
    p(6) = m(11)
    p(7) = p(2)*p(1)
    p(8) = p(1)*p(3)
    p(9) = p(2)*p(3)
    p(10) = m(12)
    p(11) = m(13) + m(14) + m(15) + m(16)
    p(12) = p(1)*p(4) - p(11)
    p(13) = p(2)*p(4)
    p(14) = m(17) + m(18) + m(19) + m(20)
    p(15) = m(21) + m(22)
    p(16) = m(23) + m(24)
    p(17) = p(3)*p(4) - p(14)
    p(18) = m(25) + m(26)
    p(19) = p(5)*p(1)
    p(20) = p(2)*p(5)
    p(21) = p(5)*p(3)
    p(22) = p(5)*p(4)
    p(23) = p(1)*p(1) - p(6) - p(6)
    p(24) = p(2)*p(2)
    p(25) = p(3)*p(3) - p(10) - p(10)
    p(26) = p(4)*p(4) - p(18) - p(16) - p(15) - p(18) - p(16) - p(15)
    p(27) = p(5)*p(5)
    p(28) = p(2)*p(6)
    p(29) = p(6)*p(3)
    p(30) = p(2)*p(8)
    p(31) = p(10)*p(1)
    p(32) = p(2)*p(10)
    p(33) = p(6)*p(4)
    p(34) = p(2)*p(11)
    p(35) = p(2)*p(12)
    p(36) = m(27) + m(28) + m(29) + m(30)
    p(37) = p(1)*p(14) - p(36)
    p(38) = p(2)*p(14)
    p(39) = p(1)*p(15)
    p(40) = p(2)*p(15)
    p(41) = m(31) + m(32)
    p(42) = p(1)*p(16) - p(41)
    p(43) = p(2)*p(16)
    p(44) = p(3)*p(11) - p(36)
    p(45) = p(1)*p(17) - p(44)
    p(46) = p(2)*p(17)
    p(47) = p(10)*p(4)
    p(48) = p(3)*p(15)
    p(49) = p(3)*p(16)
    p(50) = p(1)*p(18)
    p(51) = p(2)*p(18)
    p(52) = m(33) + m(34)
    p(53) = m(35) + m(36) + m(37) + m(38)
    p(54) = p(3)*p(18) - p(52)
    p(55) = p(5)*p(6)
    p(56) = p(2)*p(19)
    p(57) = p(5)*p(8)
    p(58) = p(2)*p(21)
    p(59) = p(5)*p(10)
    p(60) = p(5)*p(11)
    p(61) = p(5)*p(12)
    p(62) = p(2)*p(22)
    p(63) = p(5)*p(14)
    p(64) = p(5)*p(15)
    p(65) = p(5)*p(16)
    p(66) = p(5)*p(17)
    p(67) = p(5)*p(18)
    p(68) = p(6)*p(1)
    p(69) = p(2)*p(23)
    p(70) = p(2)*p(7)
    p(71) = p(3)*p(23)
    p(72) = p(2)*p(9)
    p(73) = p(1)*p(25)
    p(74) = p(2)*p(25)
    p(75) = p(10)*p(3)
    p(76) = p(1)*p(11) - p(33)
    p(77) = p(1)*p(12) - p(33)
    p(78) = p(2)*p(13)
    p(79) = p(3)*p(14) - p(47)
    p(80) = p(3)*p(17) - p(47)
    p(81) = p(4)*p(11) - p(50) - p(41) - p(39) - p(41)
    p(82) = p(1)*p(26) - p(81)
    p(83) = p(2)*p(26)
    p(84) = p(4)*p(14) - p(52) - p(49) - p(48) - p(52)
    p(85) = p(4)*p(15) - p(53)
    p(86) = p(4)*p(16) - p(53)
    p(87) = p(3)*p(26) - p(84)
    p(88) = p(4)*p(18) - p(53)
    p(89) = p(5)*p(23)
    p(90) = p(2)*p(20)
    p(91) = p(5)*p(25)
    p(92) = p(5)*p(26)
    p(93) = p(5)*p(19)
    p(94) = p(2)*p(27)
    p(95) = p(5)*p(21)
    p(96) = p(5)*p(22)
    p(97) = p(1)*p(23) - p(68)
    p(98) = p(2)*p(24)
    p(99) = p(3)*p(25) - p(75)
    p(100) = p(4)*p(26) - p(88) - p(86) - p(85)
    p(101) = p(5)*p(27)
    p(102) = p(2)*p(29)
    p(103) = p(6)*p(10)
    p(104) = p(2)*p(31)
    p(105) = p(2)*p(33)
    p(106) = p(6)*p(14)
    p(107) = p(2)*p(36)
    p(108) = p(2)*p(37)
    p(109) = p(6)*p(15)
    p(110) = p(2)*p(39)
    p(111) = p(6)*p(16)
    p(112) = p(2)*p(41)
    p(113) = p(2)*p(42)
    p(114) = p(6)*p(17)
    p(115) = p(2)*p(44)
    p(116) = p(2)*p(45)
    p(117) = p(10)*p(11)
    p(118) = p(10)*p(12)
    p(119) = p(2)*p(47)
    p(120) = m(39) + m(40) + m(41) + m(42)
    p(121) = p(1)*p(48) - p(120)
    p(122) = p(2)*p(48)
    p(123) = p(10)*p(15)
    p(124) = p(3)*p(41)
    p(125) = p(3)*p(42)
    p(126) = p(2)*p(49)
    p(127) = p(10)*p(16)
    p(128) = p(6)*p(18)
    p(129) = p(2)*p(50)
    p(130) = p(1)*p(52)
    p(131) = p(2)*p(52)
    p(132) = m(43) + m(44) + m(45) + m(46)
    p(133) = p(1)*p(53) - p(132)
    p(134) = p(2)*p(53)
    p(135) = m(47) + m(48) + m(49) + m(50)
    p(136) = m(51)
    p(137) = p(1)*p(54)
    p(138) = p(2)*p(54)
    p(139) = p(10)*p(18)
    p(140) = p(3)*p(53) - p(135)
    p(141) = p(2)*p(55)
    p(142) = p(5)*p(29)
    p(143) = p(2)*p(57)
    p(144) = p(5)*p(31)
    p(145) = p(2)*p(59)
    p(146) = p(5)*p(33)
    p(147) = p(2)*p(60)
    p(148) = p(2)*p(61)
    p(149) = p(5)*p(36)
    p(150) = p(5)*p(37)
    p(151) = p(2)*p(63)
    p(152) = p(5)*p(39)
    p(153) = p(2)*p(64)
    p(154) = p(5)*p(41)
    p(155) = p(5)*p(42)
    p(156) = p(2)*p(65)
    p(157) = p(5)*p(44)
    p(158) = p(5)*p(45)
    p(159) = p(2)*p(66)
    p(160) = p(5)*p(47)
    p(161) = p(5)*p(48)
    p(162) = p(5)*p(49)
    p(163) = p(5)*p(50)
    p(164) = p(2)*p(67)
    p(165) = p(5)*p(52)
    p(166) = p(5)*p(53)
    p(167) = p(5)*p(54)
    p(168) = p(2)*p(68)
    p(169) = p(2)*p(28)
    p(170) = p(6)*p(8)
    p(171) = p(2)*p(71)
    p(172) = p(2)*p(30)
    p(173) = p(10)*p(23)
    p(174) = p(2)*p(32)
    p(175) = p(6)*p(25)
    p(176) = p(2)*p(73)
    p(177) = p(10)*p(8)
    p(178) = p(2)*p(75)
    p(179) = p(6)*p(11)
    p(180) = p(6)*p(12)
    p(181) = p(2)*p(76)
    p(182) = p(2)*p(77)
    p(183) = p(2)*p(34)
    p(184) = p(2)*p(35)
    p(185) = p(1)*p(36) - p(106)
    p(186) = p(1)*p(37) - p(106)
    p(187) = p(2)*p(38)
    p(188) = p(3)*p(36) - p(117)
    p(189) = p(1)*p(79) - p(188)
    p(190) = p(2)*p(79)
    p(191) = p(15)*p(23)
    p(192) = p(2)*p(40)
    p(193) = p(1)*p(41) - p(111)
    p(194) = p(1)*p(42) - p(111)
    p(195) = p(2)*p(43)
    p(196) = p(1)*p(44) - p(114)
    p(197) = p(1)*p(45) - p(114)
    p(198) = p(2)*p(46)
    p(199) = p(10)*p(14)
    p(200) = p(3)*p(44) - p(117)
    p(201) = p(1)*p(80) - p(200)
    p(202) = p(2)*p(80)
    p(203) = p(10)*p(17)
    p(204) = p(15)*p(25)
    p(205) = p(16)*p(25)
    p(206) = p(18)*p(23)
    p(207) = p(2)*p(51)
    p(208) = p(3)*p(52) - p(139)
    p(209) = p(3)*p(54) - p(139)
    p(210) = p(6)*p(26)
    p(211) = p(2)*p(81)
    p(212) = p(2)*p(82)
    p(213) = p(4)*p(36) - p(130) - p(124) - p(121)
    p(214) = p(1)*p(84) - p(213)
    p(215) = p(2)*p(84)
    p(216) = p(11)*p(15) - p(132)
    p(217) = p(1)*p(85) - p(216)
    p(218) = p(2)*p(85)
    p(219) = p(14)*p(15) - p(135)
    p(220) = p(4)*p(41) - p(132)
    p(221) = p(1)*p(86) - p(220)
    p(222) = p(2)*p(86)
    p(223) = p(14)*p(16) - p(135)
    p(224) = p(15)*p(16)
    p(225) = p(3)*p(81) - p(213)
    p(226) = p(1)*p(87) - p(225)
    p(227) = p(2)*p(87)
    p(228) = p(10)*p(26)
    p(229) = p(3)*p(85) - p(219)
    p(230) = p(3)*p(86) - p(223)
    p(231) = p(11)*p(18) - p(132)
    p(232) = p(1)*p(88) - p(231)
    p(233) = p(2)*p(88)
    p(234) = p(4)*p(52) - p(135)
    p(235) = p(15)*p(18)
    p(236) = p(16)*p(18)
    p(237) = p(3)*p(88) - p(234)
    p(238) = p(5)*p(68)
    p(239) = p(2)*p(89)
    p(240) = p(2)*p(56)
    p(241) = p(5)*p(71)
    p(242) = p(2)*p(58)
    p(243) = p(5)*p(73)
    p(244) = p(2)*p(91)
    p(245) = p(5)*p(75)
    p(246) = p(5)*p(76)
    p(247) = p(5)*p(77)
    p(248) = p(2)*p(62)
    p(249) = p(5)*p(79)
    p(250) = p(5)*p(80)
    p(251) = p(5)*p(81)
    p(252) = p(5)*p(82)
    p(253) = p(2)*p(92)
    p(254) = p(5)*p(84)
    p(255) = p(5)*p(85)
    p(256) = p(5)*p(86)
    p(257) = p(5)*p(87)
    p(258) = p(5)*p(88)
    p(259) = p(5)*p(55)
    p(260) = p(2)*p(93)
    p(261) = p(5)*p(57)
    p(262) = p(2)*p(95)
    p(263) = p(5)*p(59)
    p(264) = p(5)*p(60)
    p(265) = p(5)*p(61)
    p(266) = p(2)*p(96)
    p(267) = p(5)*p(63)
    p(268) = p(5)*p(64)
    p(269) = p(5)*p(65)
    p(270) = p(5)*p(66)
    p(271) = p(5)*p(67)
    p(272) = p(6)*p(6)
    p(273) = p(6)*p(23)
    p(274) = p(2)*p(97)
    p(275) = p(2)*p(69)
    p(276) = p(2)*p(70)
    p(277) = p(3)*p(97)
    p(278) = p(2)*p(72)
    p(279) = p(23)*p(25)
    p(280) = p(2)*p(74)
    p(281) = p(10)*p(10)
    p(282) = p(1)*p(99)
    p(283) = p(2)*p(99)
    p(284) = p(10)*p(25)
    p(285) = p(1)*p(76) - p(179)
    p(286) = p(1)*p(77) - p(180)
    p(287) = p(2)*p(78)
    p(288) = p(3)*p(79) - p(199)
    p(289) = p(3)*p(80) - p(203)
    p(290) = p(1)*p(81) - p(210)
    p(291) = p(1)*p(82) - p(210)
    p(292) = p(2)*p(83)
    p(293) = p(3)*p(84) - p(228)
    p(294) = p(15)*p(15) - p(136) - p(136)
    p(295) = p(16)*p(16) - p(136) - p(136)
    p(296) = p(3)*p(87) - p(228)
    p(297) = p(18)*p(18) - p(136) - p(136)
    p(298) = p(4)*p(81) - p(231) - p(220) - p(216)
    p(299) = p(1)*p(100) - p(298)
    p(300) = p(2)*p(100)
    p(301) = p(4)*p(84) - p(234) - p(223) - p(219)
    p(302) = p(15)*p(26) - p(236)
    p(303) = p(16)*p(26) - p(235)
    p(304) = p(3)*p(100) - p(301)
    p(305) = p(18)*p(26) - p(224)
    p(306) = p(5)*p(97)
    p(307) = p(2)*p(90)
    p(308) = p(5)*p(99)
    p(309) = p(5)*p(100)
    p(310) = p(5)*p(89)
    p(311) = p(2)*p(94)
    p(312) = p(5)*p(91)
    p(313) = p(5)*p(92)
    p(314) = p(5)*p(93)
    p(315) = p(2)*p(101)
    p(316) = p(5)*p(95)
    p(317) = p(5)*p(96)
    p(318) = p(1)*p(97) - p(273)
    p(319) = p(2)*p(98)
    p(320) = p(3)*p(99) - p(284)
    p(321) = p(4)*p(100) - p(305) - p(303) - p(302)
    p(322) = p(5)*p(101)

    return
  end subroutine evpoly

end module basis
